if ( ENABLE_SHARED )
    set(libbroker broker)
else ()
    set(libbroker brokerStatic)
endif ()

macro(unit_test name)
    add_executable(${name} ${name}.cc)
    target_link_libraries(${name} ${libbroker})
    add_test(NAME ${name} COMMAND ${name})

    foreach (_arg ${ARGN})
        add_test(NAME ${name}_${_arg} COMMAND ${name} ${_arg})
    endforeach ()
endmacro()

unit_test(test_print)
unit_test(test_print_remote)
unit_test(test_event remote)
unit_test(test_log remote)
unit_test(test_store_master)
unit_test(test_store_clone)
unit_test(test_store_frontend)
unit_test(test_store_remote)
unit_test(test_subscription_matching)
unit_test(test_variant)
unit_test(test_optional)
unit_test(test_data)
unit_test(test_radix_tree)
